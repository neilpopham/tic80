-- title:  Camera Tutorial
-- author: trelemar
-- desc:   How to efficiently draw a scrolling map
-- script: lua
function sign(n) return n>0 and 1 or n<0 and -1 or 0 end
function lerp(a,b,t) return (1-t)*a + t*b end

function init()
 t=0 --frame count or time
 p={x=120,y=64,spr=256} --player
 cam={x=120,y=64}
 l="\n"
 s=" "
end

init()
function TIC()
cls(1)
cam.x=math.min(120,lerp(cam.x,120-p.x,0.05))
cam.y=math.min(64,lerp(cam.y,64-p.y,0.05))
--cam.x=math.min(120,120-p.x)
--cam.y=math.min(64,64-p.y)

dx,dy=cam.x-120,cam.y-64
local ccx=cam.x/8+(cam.x%8==0 and 1 or 0)
local ccy=cam.y/8+(cam.y%8==0 and 1 or 0)
map(15-ccx,8-ccy,31,18,(cam.x%8)-8,(cam.y%8)-8,0)

if btn(0) then p.y=p.y-1 end
if btn(1) then p.y=p.y+1 end
if btn(2) then p.x=p.x-1 end
if btn(3) then p.x=p.x+1 end
 
spr(p.spr,p.x+cam.x,p.y+cam.y)
rect(cam.x-120+8,cam.y-64+8,8,8,2)

line(0,68,240,68,15)
line(120,0,120,136,15)
end
-- <TILES>
-- 000:5555555555555555555555555555555555555555555555555555555555555555
-- 001:555555555bb555555555555555555b555555555555b5555555555bb555555555
-- 002:bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
-- 003:bbbbbbbbb55bb55bbbbbb5bbbbbbbbbbbbbbbbbbbb5bbb5bbbbbbb5bbbbbbbbb
-- 004:4444444444444444444444444444444444444444444444444444444444444444
-- 016:6666666666666666666666666666666666666666666666666666666666666666
-- </TILES>

-- <SPRITES>
-- 000:ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
-- </SPRITES>

-- <MAP>
-- 000:010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 001:000000000000000000000020303000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 002:000000000000000000303020300000000000000000000000000000000020202020000000000000404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 003:000000000010000000202020300010000000000000000000200000101020202020200000000010004040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 004:000000100000000000002020200000000000000010102020200000001010102000000000000010000040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 005:000000000000000000000000000000000000000000102020303000000010000000000000000010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 006:000010000040404010100000100000004040404000001030300000000000000040400000203030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 007:000000100040404000000000000010000040000000000000000000202000000040302020202030000000001000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 008:000000000000004000000000000000000000000000000000000020202020000000302020202000001000000010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 009:000000000000000000000000000000000000000010000000000000202020000000003030300000001000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 010:000000000000000000000000000000000000000010000000100000200020000010000000200000101000002020203000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 011:000000000000000000000000000000001000000010003000101010100000001000000000000000000000202020303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 012:000000000000203030000000101010104000000000303030301000000000001000004040000000000000202030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 013:000000000030203030302020000000404000002020202020000000000000000000004040001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 014:000000101030302020202000000000400000000020202020000000000030003030000000101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 015:000000000000000020200000000000000000000020202000000000003020202020200000001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 016:000000000000003030300000000000000000000000002000000000000000002010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 017:000000000000000000004000000010000000000000000000004040400000002010100000000000200000000000101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 018:000000000000000000404000001000101000000000001010000000404000001010100000003020200030301010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 019:000000000000000040400000101010101000000000000000101000000000000010101000303020202030300010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 020:000000000020000000000000000010102020200000000000100000000000000000000000003020202020303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 021:000020202020200000000000000000000000202020202020200000000000000000000000003030302020003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 022:000020202020000000000000000000000000303020302020200030303000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 023:000000202020000000000000404000000000003030300000000030300000000010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 024:000000000000000000000040400000000000000000000000000000000000001010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 025:000000000000000000000000000000000000000000000000000010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 026:000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 027:000000000000000000000000000000000000000000000000101010001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 028:000000000000000000000000000000000000000000000000100010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- </MAP>

-- <WAVES>
-- 000:00000000ffffffff00000000ffffffff
-- 001:0123456789abcdeffedcba9876543210
-- 002:0123456789abcdef0123456789abcdef
-- </WAVES>

-- <SFX>
-- 000:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000304000000000
-- </SFX>

-- <PALETTE>
-- 000:140c1c44243430346d4e4a4e854c30346524d04648757161597dced27d2c8595a16daa2cd2aa996dc2cadad45edeeed6
-- </PALETTE>

-- <COVER>
-- 000:bd6000007494648373160f0088003b000041c0c14442430343d6e4a4e458c4034356420d648457171695d7ec2dd7c258591ad6aac22daa99d62cacad4de5edee6dc2000000000f0088000040ff0b8c94ba428336bcbbff068ed24696e9b07f88396a1a07c2fc13b6fd87eafe83de7cb2e94e74cf90f88c4a2195c660589a20968dc66f2ab49263bcdee4aa4c72fe4a5031db8e4ba9566f9877de6f8dbbd5bdd61f9db57970fdff08d5d704c492525638829357a4c818f8619882b7b846290336e8743509d9f5795249750a33e96a7a3ad62a58978aeaf1c9fa4517bab9457ba58bc9a97528cb2b09d75b05628878891b0cacf52b2c8638c5fb37bce9ec47d74dac2d1c973c99560e7c357cd847dcbd776deb5c8ca88e739cd8fe9d95ae1d8d4f9f7a53c103ed67cf6fd99741f29414c389afd4ae55f2122c843f02a11d7f720650f7eac265b185dcc5aa26a0fff4cfbe0111693c54dfa2d44a800f4250c88a4367a2233d32f179f9442ac68a8a74a483c1766941170d46f4986264a243883f1e5c2943956bc3af4576cc6a4038e2399fa49a450a17c4af22aab6403a288678a485554fb22c0b4fc29a5b3e5dde74f346509152312c19fdf963efdcdfa8f2b1757557deeb5930bc6a85273200fb49c73a6d06bb58144bdf642d211d3b0a1265efca81e5ba8b851552e2dd7f43707191e919adcc565b808d8b36f558b1f27f33d5156750f1e56967216b3837bfedd3096f2f573ecd9479b08c67805e8b33ac93b712bf5b9d713d80ec18d16b678bfadb347055d1d497717e91b49a0fcfe58b8e680ffd734348e63ed1fe9601fdff91788865f1f42e8c5a02b3f41a12859410ae6209c79e997fd192de97111e60cc99150c68408963bd1691671022b64fd6822e88455726d18072676255c8c60b89adf1f2e70432a8f1aa8b89d850a9293a70b36469f419a9109c7909ee9f8c36f811ea8a4e567c53915a1941129b7d49aa959102964f86966d496cda13467026ad570e21c260203125e3c39a4ca92f087080175088287a07df5122a538ac0d9c49d9511b3a72b32d9c99480aca06877e2412da45e44249992c8e6232ab9092c94382a84c5a4c01a9e4e792c1abf583396874960aaedd32ae4578c1a88a76d0df9f2159376ba802b7f8a55c9692e9216991ca43c30d660bb5d0bb6ce9efc1b89affda8cef8e16fa8fd42ec64bfa0434d61b7da145926b192584cae1dd28b6a86b58ee72259b07c7b6e68b3d61a3beab996da08ebb0f2e52fab1f04fbefa1b8e2ebc21987acfbffa1314a0c8c21c24a1cdf22c1d14ba0b0bd2ac2e0f3cc0f4cd1c5cc177ce1f7c0278c22f8c4279c62f9c827aca237c9f46ce2e5c013eaa1303e2342c23f3f7dcc41f29accdce25a5a3be353f322b2fc14f1dd2088abe70543844dc0d84bd0a4f2de143d2e84ca965c15f1135b582285d56a05a5f6dc347d0f1b0067d19376d6439d2489d202add9d8d3062ce6fbd07378f5fcdc7dadcd0dd77fd097bed124ad7fe729510e183b038788277eb23f58e4f2e6786976a4e1f655292ff897ba048537de42508c16d163e10c545ba2f99bcc70435eddd5951c5ebe5cc0c2c901faec78bb77aee8385e979aa0c36aea96e17e46ba60eebb16acec2b9ffe6cf9bcbbe09c394fd64e88728a5d5faf146e739e6dfd4f93971af40f0a7f3826fdc33f5d24688f1e46f4f9ce0f7b66fea7712b76246651c057e255bea64d5efb6f9660837a3c78ae671669af121ee70695f9303117bb2dd1fe9730b8e901ca3ddbe31fd2f74fb90a20743d12e061f0e1614a9590f80989c0ec7a537a24f5b22148a2c2d25cd7d2b0d871038634ef1cb2280e14607ee38189ab980b678f34fc4c818c6a12670177aebccd8ac3184c94907e8570c0e849c9820b82e9f845c5a67ff4e52064012a1a649832cfc8cf2b836423211d3806c47041153aeac41c09d7f895e5aba441f371ad8228754d7d113d8a648a5f130939333102594b14bb52190928cb06c5808baba22ae455804cc1325192e1042f0714d14ae852f29fd301861b15c528c9c6049d6bc4a2f2f798490e02f29874d609aa58bd3b2c258e8bb24568299678cd4ecb2d780b51ea74791b4a9170b59bbc622a21996bc8d1013c8194661ec68367466142b29ec43dc33b88c54d36d0421b14f5e5dc203acd6efa049ccc9429f6a16eca19e21394b357ea5ad9f4c93e307651f497ed2ce93b4c5ec3d724fcb2a83b4101cd16b38659d40f504394fec2a4b13f4b0dfb911379b64e5644d09d47d4b6a033a1915d061e6f720c092e2478493e4e30998bb2e1601f2abd2c26d9089a2067250991e14f8abde1ab5ce4d3e85a5fca56f37c12b1a52f767a6aba9e6496a1cb5cd47e79045cc1f198a02d19a8415a45d8a1e4949a3ddb1f47ba553eaa759c9904a16005aa46dfaa26ac966d99d87c8aa24516a55f186d7ba2cc235dbaba155ea4192f985378355752a222000b3
-- </COVER>

