-- title:  runjumpdie
-- author: Neil Popham
-- desc:
-- script: lua
-- input:  gamepad
-- saveid:

pad={left=2,right=3,up=0,down=1,btn1=4,btn2=5,btn3=6,btn4=7}
screen={width=240,height=136,x2=239,y2=135}
dir={left=1,right=2}
drag={air=0.95,ground=0.65,gravity=0.7}

require "carts/projects/gunslugs/pico8"
require "carts/projects/gunslugs/functions"
require "carts/projects/gunslugs/particles"
require "carts/projects/gunslugs/camera"
require "carts/projects/gunslugs/objects"
require "carts/projects/gunslugs/button"
require "carts/projects/gunslugs/destructables"
require "carts/projects/gunslugs/weapons"
require "carts/projects/gunslugs/enemies"
require "carts/projects/gunslugs/player"
require "carts/projects/gunslugs/bullets"
require "carts/projects/gunslugs/pickups"
require "carts/projects/gunslugs/levels"
require "carts/projects/gunslugs/stages/transition"
require "carts/projects/gunslugs/stages/intro"
require "carts/projects/gunslugs/stages/main"
require "carts/projects/gunslugs/stages/over"

function _init()
 enemies=collection:create()
 particles=collection:create()
 bullets=bullet_collection:create()
 destructables=collection:create()
 pickups=collection:create()
 stage=stage_intro
 draw_stage=stage
 stage:init()
end

function _update60()
 stage:update()
end

function _draw()
 cls()
 draw_stage:draw()
 draw_stage=stage
end

function TIC()
 _draw() _update60()
end

_init()

-- <TILES>
-- 001:777777767666666d7666666d7666666d7666666d7666666d7666666d6ddddddd
-- 002:aaaaaaa9a999999494444444a9999994a9999994aaaaaaa4a999999494444444
-- 003:8e6e882228e822228e6e8822822288222e2e2822822288228e6e882228e82222
-- 004:b6a6bb333b6b3333b6a6bb33b333bb333a3a3b33b333bb33b6a6bb333b6b3333
-- 006:000000001d6d11111d6d11111d6d111101d11110088000000000000000000000
-- 007:000000001d6d11111d6d11111d6d111101d11110000880000000000000000000
-- 008:000000001d6d11111d6d11111d6d111101d11110000008800000000000000000
-- 009:0000111100001111000011110000000000000000000000000000000000000000
-- 010:1110000011100000111000000000000011111110111111101111111000000000
-- 011:0000000000000000000000000000000011111110111111101111111000000000
-- 012:1110111111101111111011110000000000000000000000000000000000000000
-- 013:1110111111101111111011110000000011111110111111101111111000000000
-- 016:1111111104444411014144110444441104124410633333300334433002202220
-- 017:0000000011111111044444110141441104444411641244100443333000002220
-- 018:0000000011111111044444110141441104444411641244100333442002200000
-- 019:1111111111444440114414101144444001442140033336660331133002220220
-- 020:0000000011111111114444401144141011444440014421460331133002220000
-- 021:0000000011111111114444401144141011444440014421460222133000000220
-- 022:1111111114444441141441411444444114211241633333301333333002200220
-- 026:0000000066777766677887767788887777888877677887766677776600000000
-- 027:0000000006677770067788e00678888006788880067788e00667777000000000
-- 028:0000000000d6770000d6e80000d6880000d6880000d6e80000d6770000000000
-- 029:00000000000dd000000dd000000dd000000dd000000dd000000dd00000000000
-- 030:0000000000776d00008e6d0000886d0000886d00008e6d0000776d0000000000
-- 031:00000000077776600e88776008888760088887600e8877600777766000000000
-- 032:a7000000aa000000000000000000000000000000000000000000000000000000
-- 033:ba000000bb000000000000000000000000000000000000000000000000000000
-- 034:0990000099a90000999900000990000000000000000000000000000000000000
-- 035:02220000228e2000288820002282200002220000000000000000000000000000
-- 040:0000000008888880888778888877778888777788888778880888888000000000
-- 041:0000000000288800028878800287778002877780028878800028880000000000
-- 042:0000000000028000002288000028780000287800002288000002800000000000
-- 043:0000000000022000000220000002200000022000000220000002200000000000
-- 044:0000000000082000008822000087820000878200008822000008200000000000
-- 045:0000000000888200088788200877782008777820088788200088820000000000
-- 046:00000000055055005ddddd505ddd6d505ddddd5005ddd500005d500000050000
-- 047:0000000002202200288888202888e82028888820028882000028200000020000
-- 048:0f7fffff0f7fffff0171ffff0f7fffff0f7fffff6dddddd00dd11dd005505550
-- 049:000000000f7fffff0f7fffff0171ffff0f7fffff6f7fffff011dddd000005550
-- 050:000000000f7fffff0f7fffff0171ffff0f7fffff6f7fffff0ddd115005500000
-- 051:f7fffff0f7fffff0f7ff1f10f7fffff0f7fffff00dddd6660dd11dd005550550
-- 052:00000000f7fffff0f7fffff0f7ff1f10f7fffff0f7fffff60dd11dd005550000
-- 053:00000000f7fffff0f7fffff0f7ff1f10f7fffff0f7fffff605551dd000000550
-- 054:ff7fffffff7ffffff1dff11fff7fffffff7fffff65ddddd0d5ddddd005500550
-- 055:000000000001311000111211071121230c111211333111316331113030303030
-- 056:00000000011310001121110032121170112111c0131113330311133603030303
-- 057:000000000001311000111211071121230c111211333111316313111303030303
-- 058:00000000011310001121110032121170112111c0131113333111313630303030
-- 061:0d00000066666666dddddddd1116000055500000555000000000000000000000
-- 062:0000d000000266664444dddd4444206044400600000000000000000000000000
-- 063:0000000066666666dddddddd4444400000000000000000000000000000000000
-- </TILES>

-- <WAVES>
-- 000:00000000ffffffff00000000ffffffff
-- 001:0123456789abcdefedcba98765432100
-- 002:00123456789abcdedcba456789aba987
-- 003:2456789abcddeeedcb98654321100000
-- 004:6655443332222222233334455667889a
-- 005:1577dc59fd88bc9f4a27d7deac54ca3e
-- </WAVES>

-- <SFX>
-- 000:d100c100b100a1008100710071006100610061006100610071008100810081009100a100a100a100a100b100b100c100d100d100e100e100e100f100507000000000
-- 001:f130e100c130a10091308100713071007130710081309100a130a100b130c100d130e100f130f100f130f100f130f100f130f100f130f100f130f100410000000000
-- 002:956bb56bd55ce55ce55ef55ff550f550f551f551f551f561f562f562f562f562f572f572f582f581f571f560f56ff56ef56df56df56df56cf56cf56c009000000000
-- 003:05301540254f555b655a656a756a856995699568a568b578b578c578c578c578d578d578d578e57fe57fe57ee57ee57de57ce57cf57bf57af57af579009000000000
-- 004:05c825b835983588756885689558a548b538c538d528e518e508f568f568f568f578f578f588f588f578f568f568f568f568f568f568f568f568f568009000000000
-- 005:21c311c11190117f216e214d314d317e31a031b141d241e441e541e54151414f513e513e514e614e615d617d718d819e91afa190b171d172e162e160202000000000
-- 006:8100810081008100810081008100810081009100910091009100a100a100b100b100b100c100c100c100d100d100d100e100e100e100f100f100f100205000000000
-- </SFX>

-- <PALETTE>
-- 000:0000001d2b537e2553008751ab52365f574fc2c3c7fff1e8ff004dffa300ffec2700e43629adff83769cff77abffccaa
-- </PALETTE>

-- <COVER>
-- 000:27b000007494648393160f00880077000012ffb0e45445353414055423e2033010000000129f40402000ff00c2000000000f008800780000002c3c7cff3a003867c9e75235ff00d4ff77bad1b235f575f4ffce72ba2563ff1f8e007815004e6300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080ff001080c1840b0a1c388031a2c58c0b1a3c780132a4c9841b2a2c0010a226c3820a3e04f86134a84383064a9c39409001000a2706bc6920f5eac89b2162bca93350e6c188133208d9e3b7ae4f940d3a1509823924ce9c498a2d7ab0904189a35b625daac2fa610ba759b25dc9b3f766cd8045ca9d0bf1d8a044a05bde1c10073e2c57b47d0a4d9a606b665cba7fe618cbe510fedfba7782f44b245c2154bb650cad6c5732b0c3049d9a4e8ce71b66eeba5dba6eec4031726d91a3ce8e6ce8104746b79f92287dda36bfdc93bd5e75bd8536ede8dcb9eeb640dbf2b4dc9ab987653e3cb062f0eccb9b3f096c36e1c8ec27af3fbe8d3bb6fdecdbbb7ffe0e3cb8fff1f4ebcb9f1f493d35600ae3d3bf6f70ed7b79fae9ebb78f1f1fbdf5fafbf3cf48efdc7106d7019e77ed3430ed7ff528cfd28e0a08f06d7c06c780d48bf5e7ff51891e18d0958e1648a024822a48026383f5585226832ab7a1e98c1eb8036c81b118395a871ed8f1ea862298a3aa841a14c2e04122f84425443ac853ea724ad89321934e39b3249e3e0982ef8942e811a19142294f114d4a49856f816a3915ee85561406e08a5a29c56b9e6a7760e56f52b90423967a8937e4956ae9652a9b163717a469720877299c7e899661a0665974237186463823a982e9a8ee988a5af8a79f7eb9c967a8d9a9f4d4a68e5ad7a8a6a26a59e1a0a6d9aae6905daa94d9ffadaa89a9eca3ae0a8b6697098a571ca829ca4aed85b60b9b25a6c619bb2aa47a7acc63bdbe6a5b63ab6a4bb0958d2e8a29a2b8d2289aec80de29e2a549965b63e5bb862b7ce9be054a27e7b9425b21d8ba095bcd2da8eeda5e6db8f68bec6fbefefa6628bd7e94cb2ab4c67b0f20b2fe1c7c20cbc28bd5a0cfaa6b7661bbfe0c752bbcae5c50b949070cfee4c6b65c8071a427abf0b0ca0beae1bbaffebc03b0b1a6ebb1fac8236c3f2dce7edc7ed2c221db53b6b633cb48adb14bdae2787e378404fecc1b0d69a9b15fdb0c6cc65f5dd69fa4035c60b5cd133c8c2ba06b87a57bc3277d5273ca234de3e9c7139dc27cac5b8de5fcd0635986bad85fedc7b9ffd44b4d83bccbeabb28b3d94fbb7876ddde37b4f0ecf64b9876b18f2c4931e22f3d187b6d877848f6e097ac8838e58f7e99fccc37fd8a7ae01ffd93b8eb679eda74c1a32d02fec2b734f750097d6540420ebffe904a647f6956b7bd6f44caf8e5fede61bbd01945089a4dbfa6ba920ecfbe7b707877cb19fce51d6f777de3c62f405eebbba420820aefaf6d7ed6561faa3cccbfd5a250f4d7af1fb3e4475e64b1e35b46400304007833dbbf5bf4c5693911ff6f7a332d92fcd23fbaa4fe087ebb30e7f21813a5062ea96e04fcd94cc7214bf15fc283daee5efaf50db9f1102d7ce35fd909120e385539cd61343123461083cc1e20200a3cc12f0b78b3402ee0ff9682eb18801f78d34bc467a6832ae06cd6c71732fd24678d491005199265c6a4002b855422e1fc0275ce90711b807aad9c0d46ee3622cee68a5c13a813c8811736c1db89d3326b11e8b5c716870f827cd22f19f8059f36b1194a147d577409554442915f598354a81909d93c0e67c19174a46e19192a3b469441819c7cde1fe80ac44e02139183d4ae11c3b549b0c5259aa465ac5c591718a0c2759aac9bc21f98bab3c18fc1657c30de2939d447fd5f492fb4f56113388bcc89e2f89329266fc8997ac86e77838b53f4e5dc386ccef93c4a8df2c6e335b95d4e6a3bcb92dc27a5d6686abe5efb4c9f22472131a9dd4b1203fd69e467ab9ce96ecc72ae8a9afffcb0a539b4cfce722f429dec60a04b4868c38a247d9673de163148cb348050d772cb68c4438771da824131a50d3b10ae00d2c884a05a74d100880ba701939674410a25cf903d35f5378aaf04ab6c2f910477214480b034af09d92bfc7abeb16e247b6c3d7844032a70969290712a455ae05105ae32008454a20410225d02e4d78435fe7e2d7a6f681006560c96812745b9414e2ab45580a51dae5d0e08592306d88044dca409caa346ba60c6b6f64a77311921684aa3d61ab0b7a2855000570ba7d7ac1171b04442ae0d1be346c62152bf85ac646b1b18c6ca56178095ece667885e1d4a8634985c1da82f4b5ad15a25c4b9a54deb155b3e16deb6d5b5942dffec6b5b8bdbdae67e8a85bd6d696be74fde529c32bdfd6e6d8bbbd0e207bf8cc5046f679b5c55ee2298b2cd6e6573ab6d58e2c61528d5cea97abb7dd0fa677cb3dd4a0879cbf8c0da87f8b2dd4e6679dbfe57f6027dbee535697669300cfae7b699f5efee7b69ffd65af770c5b49521850c00e30fb29fb98d60b38f1c01e80b4872c41ea0b58f2c81ec0b6873cc1ee0f3523ae1eeb9d534c75b3c6a594cffa113a8166a2e517a872a7267173ba5c1fbc8288f9237d29e37c6c3151043020090800430a10175da6f852a74e2f0e5748059192f5bb3b4eae130e7c44e0b6a49ba726a1f77c4c6268a4e8db3c5e2cef838c34e22b34abcc192ca972acb25f2b4f2ff7a056c2b25bac35ea2f593fa945c2fa95eca7e7ac00daa47dce0b93d7c084041a7ac666b86f91bab8e1fca516ce66590c99b3f86a0a208ec566604a412d945e439760d13e09c793ec60c9330958c676da63abeabae0f48950bd4efbe399b3fae61e4958c165d431616d966e538153b0ce9c60bb2b3cebca0bf8d4c646b1b39dcce56b3bd3b5c686b2b5addc6a6f3b3881d6c6f4b5bd595af227fbdde5077c75cd7e58f69bbebede07bab7cdbee3739b3ddcee87bbbbdd0fe97bcbbed8f64febb5fd4f6e7fdbdfd6fe087ebdcd3074730cb0ebf628f1c71ea0f68b1cd1e90f78b4c32e41fe734cd2e317c875cffd717e876cd3eb171833cf3e22fe879cf3e10c3e5072875e80e69bacd5e179497cc51c33769fbcf6e537893d2d6e937c9fec57edf5e9ffcd7e14755ac8f8e84f4ab2d79ec4f6ab3df9e05f8ab48302000b3
-- </COVER>

